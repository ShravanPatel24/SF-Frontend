import{k as w,j as e,r as l,i as V,B as U}from"./index-50ad91ff.js";import{P as q}from"./PageBreadcrumb-2adbd738.js";import{S as A}from"./Spinner-57400a8f.js";import{U as G}from"./index-5266a108.js";import"./Table-9e7095d0.js";import{U as h}from"./user-12046137.js";/* empty css                     */import{R as F}from"./Row-a90e51f1.js";import{C as i}from"./Col-6e802f16.js";import{C as P}from"./Card-4e1bc556.js";import{F as r}from"./Form-57b1e97c.js";import{I as $}from"./Image-4e39bf60.js";import{B as I}from"./Button-cbb264fd.js";import"./Anchor-ceb627db.js";import"./Button-825b6efb.js";import"./index-8b12ee39.js";import"./createWithBsPrefix-d4ec82c8.js";import"./divWithClassName-189ef379.js";const T=()=>{const[d,E]=l.useState(!1),[m,f]=l.useState(""),[x,k]=l.useState(""),[j,b]=l.useState(""),[c,y]=l.useState(""),[u,v]=l.useState(""),[p,C]=l.useState(""),[N,g]=l.useState(!1),L="https://social-api.apikart.co/v1/",{slug:n}=w(),D=V();l.useEffect(()=>{(async()=>{if(n)try{const t=await h.getUserDetails(n);(t==null?void 0:t.code)===200&&(k(t.data.id),f(t.data.name),C(t.data.email),v(t.data.phone),b(t.data.image),y(t.data.image?`${L}media/preview?filename=${t.data.image}`:""))}catch(t){console.error("Error fetching category:",t)}})()},[n]);const B=async s=>{if(s.currentTarget.checkValidity()===!1)s.preventDefault(),s.stopPropagation();else{s.preventDefault(),g(!0);try{console.log("Values saved",m,j,u,p);const o=new FormData;o.append("name",m),o.append("image",j),o.append("phone",u),o.append("email",p),console.log("Values saved",x);const a=n?await h.updateUser(o,x):await h.addUser(o);console.log("res",a==null?void 0:a.code),(a==null?void 0:a.code)===200?(g(!1),U.success(a==null?void 0:a.message),D("/users/list")):((a==null?void 0:a.code)===400||(a==null?void 0:a.code)===401)&&U.error(a==null?void 0:a.message)}finally{g(!1)}}E(!0)},R=async s=>{const t=s.target.files[0];if(console.log("ðŸš€ ~ file: addUser.tsx:45 ~ handleImage ~ file:",t),b(t),t){const o=new FileReader;o.onload=a=>{var S;y((S=a==null?void 0:a.target)==null?void 0:S.result)},o.readAsDataURL(t)}};return e.jsx(P,{children:e.jsx(P.Body,{children:e.jsxs(r,{noValidate:!0,validated:d,onSubmit:B,children:[e.jsxs(F,{children:[e.jsx(i,{lg:4,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Name"}),e.jsx(r.Control,{type:"text",id:"validationCustom01",placeholder:"Name",name:"categoryName",value:m,onChange:s=>f(s.target.value),required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Please fill the Name."})]})}),e.jsx(i,{lg:4,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Image"}),e.jsx(r.Control,{type:"file",accept:"image/*",id:"validationCustom01",placeholder:"Image",onChange:R,required:!c}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Please select the image."})]})}),c&&e.jsx(i,{lg:4,children:e.jsx(G,{children:e.jsx($,{style:{borderStyle:"solid",borderColor:"gray"},src:c,alt:"avatar",className:"avatar-lg rounded",fluid:!0})})}),e.jsx(i,{lg:4,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Email"}),e.jsx(r.Control,{type:"text",id:"validationCustom02",placeholder:"Email",name:"email",value:p,onChange:s=>C(s.target.value),required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Please fill the email."})]})}),e.jsx(i,{lg:4,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Phone Number"}),e.jsx(r.Control,{type:"text",id:"validationCustom02",placeholder:"Phone Number",name:"phone",value:u,onChange:s=>v(s.target.value),required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Please fill the phone number."})]})})]}),N?e.jsxs(I,{variant:"primary",disabled:!0,children:[e.jsx(A,{className:"spinner-border-sm",tag:"span",color:"white"})," ","Loading..."]}):e.jsx(I,{variant:"primary",type:"submit",disabled:N,children:"Submit"})]})})})},le=()=>{const{slug:d}=w();return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:d?"Edit User":"Add User",subName:"User"}),e.jsx(F,{children:e.jsx(i,{lg:12,children:e.jsx(T,{})})})]})};export{le as default};
