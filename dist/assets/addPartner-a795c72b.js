import{k as I,j as e,r as o,i as V,B as T}from"./index-50ad91ff.js";import{P as $}from"./PageBreadcrumb-2adbd738.js";import{S as z}from"./Spinner-57400a8f.js";import{U as H}from"./index-5266a108.js";import"./Table-9e7095d0.js";import{U as d}from"./user-12046137.js";import{R as E}from"./Row-a90e51f1.js";import{C as l}from"./Col-6e802f16.js";import{C as U}from"./Card-4e1bc556.js";import{F as t}from"./Form-57b1e97c.js";import{I as J}from"./Image-4e39bf60.js";import{B as w}from"./Button-cbb264fd.js";import"./Anchor-ceb627db.js";import"./Button-825b6efb.js";import"./index-8b12ee39.js";import"./createWithBsPrefix-d4ec82c8.js";import"./divWithClassName-189ef379.js";const K=()=>{const[c,L]=o.useState(!1),[m,x]=o.useState(""),[f,k]=o.useState(""),[j,y]=o.useState(""),[u,b]=o.useState(""),[p,v]=o.useState(""),[h,C]=o.useState(""),[S,N]=o.useState(""),[P,A]=o.useState([]),[B,g]=o.useState(!1),D="https://social-api.apikart.co/v1/",{slug:n}=I(),R=V();o.useEffect(()=>{const r=async()=>{if(n)try{const a=await d.getUserDetails(n);(a==null?void 0:a.code)===200&&(k(a.data.id),x(a.data.name),C(a.data.email),v(a.data.phone),y(a.data.image),b(a.data.image?`${D}media/preview?filename=${a.data.image}`:""),N(a.data.businessType||""))}catch(a){console.error("Error fetching category:",a)}},i=async()=>{try{const a=await d.getBusinessTypes();console.log("Business Types Response:",a),(a==null?void 0:a.code)===200?A(a.data.docs||[]):console.error("Failed to fetch business types:",a)}catch(a){console.error("Error fetching business types:",a)}};r(),i()},[n]);const q=async r=>{if(r.currentTarget.checkValidity()===!1)r.preventDefault(),r.stopPropagation();else{r.preventDefault(),g(!0);try{console.log("Values saved",m,j,p,h);const a=new FormData;a.append("name",m),a.append("image",j),a.append("phone",p),a.append("email",h),a.append("businessType",S),console.log("Values saved",f);const s=n?await d.updateUser(a,f):await d.addUser(a);console.log("res",s==null?void 0:s.code),(s==null?void 0:s.code)===200?(g(!1),T.success(s==null?void 0:s.message),R("/users/list")):((s==null?void 0:s.code)===400||(s==null?void 0:s.code)===401)&&T.error(s==null?void 0:s.message)}finally{g(!1)}}L(!0)},G=async r=>{const i=r.target.files[0];if(console.log("ğŸš€ ~ file: addUser.tsx:45 ~ handleImage ~ file:",i),y(i),i){const a=new FileReader;a.onload=s=>{var F;b((F=s==null?void 0:s.target)==null?void 0:F.result)},a.readAsDataURL(i)}};return e.jsx(U,{children:e.jsx(U.Body,{children:e.jsxs(t,{noValidate:!0,validated:c,onSubmit:q,children:[e.jsxs(E,{children:[e.jsx(l,{lg:4,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Name"}),e.jsx(t.Control,{type:"text",id:"validationCustom01",placeholder:"Name",name:"name",value:m,onChange:r=>x(r.target.value),required:!0}),e.jsx(t.Control.Feedback,{type:"invalid",children:"Please fill the Name."})]})}),e.jsx(l,{lg:4,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Image"}),e.jsx(t.Control,{type:"file",accept:"image/*",id:"validationCustom01",placeholder:"Image",onChange:G,required:!u}),e.jsx(t.Control.Feedback,{type:"invalid",children:"Please select the image."})]})}),u&&e.jsx(l,{lg:4,children:e.jsx(H,{children:e.jsx(J,{style:{borderStyle:"solid",borderColor:"gray"},src:u,alt:"avatar",className:"avatar-lg rounded",fluid:!0})})}),e.jsx(l,{lg:4,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Email"}),e.jsx(t.Control,{type:"text",id:"validationCustom02",placeholder:"Email",name:"email",value:h,onChange:r=>C(r.target.value),required:!0}),e.jsx(t.Control.Feedback,{type:"invalid",children:"Please fill the email."})]})}),e.jsx(l,{lg:4,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Phone Number"}),e.jsx(t.Control,{type:"text",id:"validationCustom02",placeholder:"Phone Number",name:"phone",value:p,onChange:r=>v(r.target.value),required:!0}),e.jsx(t.Control.Feedback,{type:"invalid",children:"Please fill the phone number."})]})}),e.jsx(l,{lg:4,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Business Type"}),e.jsxs(t.Control,{as:"select",value:S,onChange:r=>N(r.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Business Type"}),Array.isArray(P)?P.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id)):e.jsx("option",{disabled:!0,children:"Loading..."})]}),e.jsx(t.Control.Feedback,{type:"invalid",children:"Please select a business type."})]})})]}),B?e.jsxs(w,{variant:"primary",disabled:!0,children:[e.jsx(z,{className:"spinner-border-sm",tag:"span",color:"white"})," ","Loading..."]}):e.jsx(w,{variant:"primary",type:"submit",disabled:B,children:"Submit"})]})})})},de=()=>{const{slug:c}=I();return e.jsxs(e.Fragment,{children:[e.jsx($,{title:c?"Edit Partner":"Add Partner",subName:"Partner"}),e.jsx(E,{children:e.jsx(l,{lg:12,children:e.jsx(K,{})})})]})};export{de as default};
